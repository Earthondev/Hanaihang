# üè¢ Pattern ‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö Database ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≤‡∏á

## üìã **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö Database ‡∏Ç‡∏≠ (‡∏ï‡∏≤‡∏° MallFormData Interface)**

### ‚úÖ **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (Required)**

```typescript
{
  "displayName": "‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á (‡πÄ‡∏ä‡πà‡∏ô CentralWorld, Siam Paragon)"
}
```

### üìû **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)**

```typescript
{
  "phone": "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÄ‡∏ä‡πà‡∏ô 02-123-4567)",
  "website": "‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå (‡πÄ‡∏ä‡πà‡∏ô https://www.centralworld.co.th)",
  "social": "‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢ (‡πÄ‡∏ä‡πà‡∏ô https://facebook.com/centralworld)"
}
```

### üìç **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)**

```typescript
{
  "lat": 13.7472,
  "lng": 100.5396
}
```

### ‚è∞ **‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)**

```typescript
{
  "openTime": "10:00",
  "closeTime": "22:00"
}
```

### üè¢ **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)**

```typescript
{
  "address": "‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏ï‡πá‡∏° (‡πÄ‡∏ä‡πà‡∏ô 999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏∏‡∏°‡∏û‡∏¥‡∏ô‡∏µ ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330)",
  "district": "‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô, ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á)"
}
```

### üîß **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)**

```typescript
{
  "name": "slug-‡∏Ç‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏á (‡πÄ‡∏ä‡πà‡∏ô central-world) - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"
}
```

## üéØ **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö**

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥
```json
{
  "displayName": "CentralWorld"
}
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 2: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
```json
{
  "displayName": "CentralWorld",
  "address": "999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏∏‡∏°‡∏û‡∏¥‡∏ô‡∏µ ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330",
  "district": "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô",
  "phone": "02-646-1000",
  "website": "https://www.centralworld.co.th",
  "social": "https://facebook.com/centralworld",
  "lat": 13.7472,
  "lng": 100.5396,
  "openTime": "10:00",
  "closeTime": "22:00"
}
```

## üîÑ **‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥**

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á:

### 1. **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≤‡∏á‡πÉ‡∏ô Database**
```typescript
{
  "id": "auto-generated-id",
  "name": "central-world", // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å displayName
  "displayName": "CentralWorld",
  "address": "999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥...",
  "district": "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô",
  "contact": {
    "phone": "02-646-1000",
    "website": "https://www.centralworld.co.th",
    "social": "https://facebook.com/centralworld"
  },
  "coords": {
    "lat": 13.7472,
    "lng": 100.5396
  },
  "hours": {
    "open": "10:00",
    "close": "22:00"
  },
  "storeCount": 0,
  "floorCount": 6,
  "status": "Active",
  "createdAt": "2024-01-15T10:30:00Z",
  "updatedAt": "2024-01-15T10:30:00Z"
}
```

### 2. **Floors ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (6 ‡∏ä‡∏±‡πâ‡∏ô)**
```typescript
// ‡πÉ‡∏ô subcollection: malls/{mallId}/floors
[
  { "id": "floor-1", "label": "G", "order": 0 },
  { "id": "floor-2", "label": "1", "order": 1 },
  { "id": "floor-3", "label": "2", "order": 2 },
  { "id": "floor-4", "label": "3", "order": 3 },
  { "id": "floor-5", "label": "4", "order": 4 },
  { "id": "floor-6", "label": "5", "order": 5 }
]
```

## üìä **Database Structure**

### **Collection: `malls`**
```
malls/
‚îú‚îÄ‚îÄ {mallId}/
‚îÇ   ‚îú‚îÄ‚îÄ displayName: "CentralWorld"
‚îÇ   ‚îú‚îÄ‚îÄ name: "central-world"
‚îÇ   ‚îú‚îÄ‚îÄ address: "999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥..."
‚îÇ   ‚îú‚îÄ‚îÄ district: "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô"
‚îÇ   ‚îú‚îÄ‚îÄ contact: { phone, website, social }
‚îÇ   ‚îú‚îÄ‚îÄ coords: { lat, lng }
‚îÇ   ‚îú‚îÄ‚îÄ hours: { open, close }
‚îÇ   ‚îú‚îÄ‚îÄ storeCount: 0
‚îÇ   ‚îú‚îÄ‚îÄ floorCount: 6
‚îÇ   ‚îú‚îÄ‚îÄ status: "Active"
‚îÇ   ‚îú‚îÄ‚îÄ createdAt: Timestamp
‚îÇ   ‚îî‚îÄ‚îÄ updatedAt: Timestamp
```

### **Subcollection: `malls/{mallId}/floors`**
```
malls/{mallId}/floors/
‚îú‚îÄ‚îÄ {floorId1}/
‚îÇ   ‚îú‚îÄ‚îÄ label: "G"
‚îÇ   ‚îú‚îÄ‚îÄ order: 0
‚îÇ   ‚îú‚îÄ‚îÄ createdAt: Timestamp
‚îÇ   ‚îî‚îÄ‚îÄ updatedAt: Timestamp
‚îú‚îÄ‚îÄ {floorId2}/
‚îÇ   ‚îú‚îÄ‚îÄ label: "1"
‚îÇ   ‚îú‚îÄ‚îÄ order: 1
‚îÇ   ‚îú‚îÄ‚îÄ createdAt: Timestamp
‚îÇ   ‚îî‚îÄ‚îÄ updatedAt: Timestamp
‚îî‚îÄ‚îÄ ... (‡∏ä‡∏±‡πâ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
```

## üöÄ **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•**

### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏ú‡πà‡∏≤‡∏ô Admin Panel**
1. ‡πÄ‡∏Ç‡πâ‡∏≤ `http://localhost:5174/admin/malls`
2. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà"
3. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
4. ‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≤‡∏á"

### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ú‡πà‡∏≤‡∏ô API**
```javascript
// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô createMall
import { createMall } from './services/firebase/firestore';

const mallData = {
  displayName: "CentralWorld",
  address: "999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏∏‡∏°‡∏û‡∏¥‡∏ô‡∏µ ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330",
  district: "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô",
  phone: "02-646-1000",
  website: "https://www.centralworld.co.th",
  social: "https://facebook.com/centralworld",
  lat: 13.7472,
  lng: 100.5396,
  openTime: "10:00",
  closeTime: "22:00"
};

const mallId = await createMall(mallData);
console.log('‡∏´‡πâ‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ID:', mallId);
```

### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡∏ú‡πà‡∏≤‡∏ô Script**
```javascript
// ‡πÉ‡∏ä‡πâ script ‡πÄ‡∏ä‡πà‡∏ô add-mall.js
const malls = [
  {
    displayName: "CentralWorld",
    address: "999/9 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏≤‡∏ä‡∏î‡∏≥‡∏£‡∏¥ ‡πÅ‡∏Ç‡∏ß‡∏á‡∏•‡∏∏‡∏°‡∏û‡∏¥‡∏ô‡∏µ ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330",
    district: "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô",
    phone: "02-646-1000",
    website: "https://www.centralworld.co.th",
    social: "https://facebook.com/centralworld",
    lat: 13.7472,
    lng: 100.5396,
    openTime: "10:00",
    closeTime: "22:00"
  }
];

// ‡∏£‡∏±‡∏ô script
node scripts/add-mall.js
```

## ‚ö†Ô∏è **‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á**

1. **displayName**: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
2. **address**: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
3. **district**: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
4. **phone**: ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 02-123-4567 ‡∏´‡∏£‡∏∑‡∏≠ +66-2-123-4567
5. **website**: ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ http:// ‡∏´‡∏£‡∏∑‡∏≠ https://
6. **lat/lng**: ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (-90 ‡∏ñ‡∏∂‡∏á 90, -180 ‡∏ñ‡∏∂‡∏á 180)
7. **‡πÄ‡∏ß‡∏•‡∏≤**: ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö HH:MM ‡πÄ‡∏ä‡πà‡∏ô 10:00, 22:00

## üìù **Validation Rules**

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° `mallSchema`:

```typescript
const mallSchema = z.object({
  displayName: z.string().min(2, "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≤‡∏á"),
  name: z.string().optional(),
  address: z.string().min(6, "‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô"),
  district: z.string().min(2, "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠"),
  phone: z.string().optional().refine(v => v === "" || /^\+?\d[\d\s-]{6,}$/.test(v), "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"),
  website: z.string().optional().refine(v => v === "" || /^https?:\/\/.+/.test(v), "‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ http:// ‡∏´‡∏£‡∏∑‡∏≠ https://"),
  social: z.string().optional(),
  lat: z.number().min(-90).max(90).optional(),
  lng: z.number().min(-180).max(180).optional(),
  openTime: z.string().optional(),
  closeTime: z.string().optional(),
});
```

## üéâ **‡∏™‡∏£‡∏∏‡∏õ**

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á**: `displayName` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°**: ‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

**‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£**: ‡∏™‡∏£‡πâ‡∏≤‡∏á slug, floors ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô, timestamps ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
