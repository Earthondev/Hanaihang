# üéØ E2E User Journey - HaaNaiHang Search System

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° E2E ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (End-to-End User Journey)

‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‚Üí ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‚Üí ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‚Üí ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡∏≠‡∏ö/‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°

---

## üöÄ 1. Happy Path: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)

### ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
‡∏´‡∏≤ **"‡∏´‡πâ‡∏≤‡∏á/‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ"** ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

### User Journey

#### 1.1 ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
- **‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏´‡∏•‡∏î**: Hero + Search ‡πÅ‡∏•‡∏∞‡∏ñ‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå "‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏ñ‡πâ‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏ã‡πá‡∏ï‡πÉ‡∏ô state
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `page_load_time`, `gps_permission_requested`

#### 1.2 ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô "H&M")
- **Debounce**: ~120ms ‚Üí ‡∏¢‡∏¥‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ malls + stores ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
- **‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**: "‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå" ‡πÉ‡∏ï‡πâ Hero ‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‚â§250ms (cache/partial) ‡πÅ‡∏•‡∏∞ ‚â§600ms (‡∏ú‡∏•‡πÄ‡∏ï‡πá‡∏°)
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `search_latency_ms`, `from_cache`, `results_count`

#### 1.3 ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ï‡∏≤‡∏° "‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á"
- **‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞**: Web Worker ‡∏à‡∏≤‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- **‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î**: ‡∏ï‡∏¥‡∏î badge 1‚Äì3 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÉ‡∏Å‡∏•‡πâ ‚Üí ‡πÑ‡∏Å‡∏• ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£, ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `distance_calculation_time`, `ranking_accuracy`

#### 1.4 ‡∏Å‡∏£‡∏≠‡∏á "‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ" (toggle)
- **‡∏ã‡πà‡∏≠‡∏ô‡∏£‡πâ‡∏≤‡∏ô/‡∏´‡πâ‡∏≤‡∏á**: ‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î, ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á "‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ" ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `filter_usage_rate`, `open_now_filter_applied`

#### 1.5 ‡πÅ‡∏ï‡∏∞‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
- **‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤**: ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Store/Mall Detail)
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠, ‡∏ä‡∏±‡πâ‡∏ô, ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î, ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á, ‡∏õ‡∏∏‡πà‡∏° "‡∏ô‡∏≥‡∏ó‡∏≤‡∏á"
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `click_through_rate`, `result_rank_clicked`

#### 1.6 ‡πÅ‡∏ï‡∏∞ "‡∏ô‡∏≥‡∏ó‡∏≤‡∏á"
- **‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà**: Google/Apple Maps ‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏∏‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `navigation_success_rate`, `maps_app_opened`

---

## üîÑ 2. Alternative Path A: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á

### 2.1 ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò GPS
- **‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ**: ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ú‡∏• fallback (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á/‡∏ä‡∏∑‡πà‡∏≠)
- **‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥**: "‡πÄ‡∏õ‡∏¥‡∏î GPS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á"
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÑ‡∏°‡πà‡∏°‡∏µ error, ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏õ‡∏Å‡∏ï‡∏¥
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `gps_denied_rate`, `fallback_ranking_used`

### 2.2 ‡∏Å‡∏î "‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô" ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- **‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏´‡∏°‡πà**: ‚Üí re-rank ‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `gps_retry_rate`, `re_ranking_success`

---

## üè¢ 3. Alternative Path B: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡πâ‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏Å‡∏£‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô

### 3.1 ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "CentralWorld"
- **‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏´‡πâ‡∏≤‡∏á**: ‡∏î‡∏π‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏´‡πâ‡∏≤‡∏á
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÅ‡∏™‡∏î‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏° filter options

### 3.2 ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î/‡∏ä‡∏±‡πâ‡∏ô ("‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô, ‡∏ä‡∏±‡πâ‡∏ô 2")
- **Filter**: ‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î/‡∏ä‡∏±‡πâ‡∏ô
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏£‡πâ‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `mall_detail_filter_usage`

### 3.3 ‡πÅ‡∏ï‡∏∞‡∏£‡πâ‡∏≤‡∏ô ‚Üí ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡πâ‡∏≤‡∏ô ‚Üí ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á
- **Navigation**: ‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏´‡πâ‡∏≤‡∏á
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô, ‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `mall_to_store_navigation_rate`

---

## ‚ö†Ô∏è 4. Edge Cases

### 4.1 ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
- **Empty State**: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö '{q}'" + ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥/‡∏™‡∏∞‡∏Å‡∏î
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `empty_search_rate`, `suggestions_shown`

### 4.2 ‡πÄ‡∏ô‡πá‡∏ï‡∏ä‡πâ‡∏≤
- **Skeleton**: 6‚Äì9 ‡πÉ‡∏ö‡πÉ‡∏ô grid, ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î‡πÄ‡∏•‡∏¢‡πå‡πÄ‡∏≠‡∏≤‡∏ï‡πå
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: Loading state ‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `slow_network_handling`, `layout_shift_score`

### 4.3 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô
- **‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä**: "‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á"
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `location_refresh_rate`, `location_accuracy`

### 4.4 ‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î
- **‡πÉ‡∏ä‡πâ mallCoords**: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞ (‡πÄ‡∏î‡∏ô‡∏≠‡∏£‡πå‡∏°‡∏±‡∏•‡πÑ‡∏•‡∏ã‡πå‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß)
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏´‡πâ‡∏≤‡∏á
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `fallback_coordinates_used`

---

## üîÑ 5. ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥ (Returning)

### 5.1 ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≥ "‡∏Ñ‡∏≥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
- **Local Storage**: ‡∏Ñ‡∏≥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î + ‡πÅ‡∏Ñ‡∏ä‡∏ú‡∏• 2 ‡∏ô‡∏≤‡∏ó‡∏µ
- **Stale-while-revalidate**: ‡∏ú‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‚Üí ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏ú‡∏•‡∏™‡∏î‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `returning_user_rate`, `cache_hit_rate`

### 5.2 ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö ‚Üí ‡∏ú‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- **Instant Results**: ‡∏à‡∏≤‡∏Å cache
- **Background Update**: ‡∏ú‡∏•‡∏™‡∏î‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï/‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ GPS
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: TTI ‚â§ 100ms ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö returning users
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `instant_results_rate`, `background_update_success`

---

## üë®‚Äçüíº 6. ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô/‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• (‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î)

### 6.1 ‡∏Å‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Header
- **Admin Panel**: ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ "‡∏´‡πâ‡∏≤‡∏á/‡∏£‡πâ‡∏≤‡∏ô" ‡∏ú‡πà‡∏≤‡∏ô Drawer
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: UI ‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å user mode

### 6.2 ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏°‡∏µ RHF + Zod
- **Safe Submit**: toast, a11y
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: Validation ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `admin_form_submission_rate`, `validation_error_rate`

### 6.3 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏°‡∏µ search/filter/sort/pagination
- **CRUD Operations**: + ‡∏•‡∏ö‡πÅ‡∏ö‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
- ‚úÖ **‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á**: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£
- **‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å**: `admin_crud_success_rate`

---

## ‚úÖ ‡πÄ‡∏Å‡∏ì‡∏ë‡πå "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Ç‡∏≠‡∏á UX ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤" (‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)

### Performance Requirements
- ‚úÖ **‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å**: ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÇ‡∏ú‡∏•‡πà‡πÉ‡∏ï‡πâ Hero ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‚â§250ms
- ‚úÖ **Enter**: scroll ‡πÑ‡∏õ‡∏¢‡∏±‡∏á "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤" ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
- ‚úÖ **‡∏ú‡∏•‡∏£‡∏ß‡∏°**: "‡∏´‡πâ‡∏≤‡∏á + ‡∏£‡πâ‡∏≤‡∏ô" ‡πÉ‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ GPS)
- ‚úÖ **Toggle**: "‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ" ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏ß ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á

### UI/UX Requirements
- ‚úÖ **‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÉ‡∏ö**: ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î, ‡πÄ‡∏ß‡∏•‡∏≤, (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡πâ‡∏≤‡∏ô) ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≤‡∏á + ‡∏ä‡∏±‡πâ‡∏ô
- ‚úÖ **‡πÑ‡∏°‡πà‡∏°‡∏µ dropdown**: ‡πÄ‡∏Å‡∏∞‡∏Å‡∏∞, keyboard-friendly, screen reader ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏• (aria-live="polite")

---

## üß™ ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö E2E (‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏Ñ‡∏£‡∏≠‡∏ö)

### Core Test Cases
```javascript
// 1. Search Performance
test('search-type-first', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'h&m');
  await expect(page.locator('[data-testid="search-result-card"]'))
    .toBeVisible({ timeout: 250 });
});

// 2. Navigation
test('enter-scroll', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'central');
  await page.press('[data-testid="search-input"]', 'Enter');
  await expect(page.locator('#search-results')).toBeInViewport();
});

// 3. Distance Ranking
test('distance-ranking', async ({ page }) => {
  await page.context().setGeolocation({ latitude: 13.7563, longitude: 100.5018 });
  await page.fill('[data-testid="search-input"]', 'mall');
  const distances = await page.locator('[data-testid="distance"]').allTextContents();
  // Verify distances are sorted ascending
});

// 4. Filter Functionality
test('open-now-filter', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'store');
  await page.click('[data-testid="open-now-toggle"]');
  await expect(page.locator('[data-testid="closed-badge"]')).toHaveCount(0);
});

// 5. Navigation Integration
test('detail-to-navigate', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'central');
  await page.locator('[data-testid="search-result-card"]').first().click();
  await page.click('[data-testid="navigate-button"]');
  const href = await page.locator('[data-testid="navigate-button"]').getAttribute('href');
  expect(href).toMatch(/maps\.google\.com|maps\.apple\.com/);
});

// 6. No GPS Fallback
test('no-gps-fallback', async ({ page }) => {
  await page.context().clearPermissions();
  await page.fill('[data-testid="search-input"]', 'store');
  await expect(page.locator('[data-testid="search-result-card"]')).toHaveCount.greaterThan(0);
});

// 7. Empty State
test('empty-state', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'xyz123nonexistent');
  await expect(page.locator('[data-testid="empty-state"]')).toBeVisible();
});

// 8. Request Abortion
test('perf-abort', async ({ page }) => {
  await page.fill('[data-testid="search-input"]', 'c');
  await page.fill('[data-testid="search-input"]', 'ce');
  await page.fill('[data-testid="search-input"]', 'central');
  // Should only show results for final query
});
```

---

## üìä ‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏° "‡∏´‡∏≤‡∏á‡πà‡∏≤‡∏¢ ‡πÄ‡∏à‡∏≠‡πÄ‡∏£‡πá‡∏ß")

### Core Performance Metrics
- **`search_latency_ms`** (median / p95): ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‚â§400ms / ‚â§600ms
- **`search_results_count`** ‡∏ï‡πà‡∏≠ query: ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
- **`from_cache`** ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡∏ä: ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‚â•60%
- **`gps_allowed_rate`** ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‚â•30%

### User Behavior Metrics
- **`click_through_rate`** ‡∏ï‡πà‡∏≠‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö (1‚Äì3 ‡∏Ñ‡∏ß‡∏£‡∏™‡∏π‡∏á): ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
- **`empty_rate`** ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•: ‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡πâ‡∏ß‡πà‡∏≤ data coverage ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°
- **`filter_usage_rate`**: ‡∏ß‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏Å‡∏£‡∏≠‡∏á
- **`navigation_success_rate`**: ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ó‡∏≤‡∏á

### Technical Metrics
- **`cache_hit_rate`**: ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û cache system
- **`distance_calculation_time`**: ‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á
- **`ranking_accuracy`**: ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö
- **`layout_shift_score`**: ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏†‡∏≤‡∏û UI

---

## üéØ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á

### Performance Targets
- **TTI**: ‚â§250ms (cache/partial results)
- **Full Results**: ‚â§600ms (network requests)
- **SLA Compliance**: ‚â•95% (median latency ‚â§400ms)
- **Cache Hit Rate**: ‚â•60%
- **Empty Search Rate**: ‚â§15%

### User Experience Targets
- **Click-Through Rate**: Rank 1-3 ‚â•10%
- **GPS Permission Rate**: ‚â•30%
- **Navigation Success Rate**: ‚â•95%
- **Filter Usage Rate**: ‚â•20%

### Technical Targets
- **Layout Shift Score**: ‚â§0.1
- **Distance Calculation**: ‚â§50ms
- **Ranking Accuracy**: ‚â•90%
- **Error Rate**: ‚â§1%

---

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏£‡∏±‡∏ô E2E Tests
```bash
# ‡∏£‡∏±‡∏ô tests ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
npm run test:e2e

# ‡∏£‡∏±‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ search tests
npx playwright test tests/e2e/search-user-journey.spec.ts

# ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö headed mode
npm run test:e2e:headed
```

### ‡∏î‡∏π Analytics Dashboard
```bash
# ‡πÄ‡∏Ç‡πâ‡∏≤ Admin Panel
http://localhost:3000/admin

# ‡∏î‡∏π Search Analytics
http://localhost:3000/admin/search-analytics
```

### Export Performance Data
```javascript
// ‡πÉ‡∏ô browser console
const analytics = window.searchAnalytics;
const data = analytics.exportData();
console.log(data);
```

---

## üìà ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á

### Daily Monitoring
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SLA compliance rate
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° empty search rate
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå click-through patterns

### Weekly Analysis
- Review performance trends
- Identify optimization opportunities
- Update search suggestions

### Monthly Review
- Comprehensive performance report
- User behavior analysis
- Feature usage statistics

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ ‡∏ï‡∏≤‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ **"‡∏ä‡∏±‡∏î/‡∏´‡∏≤‡∏á‡πà‡∏≤‡∏¢/‡πÄ‡∏à‡∏≠‡πÄ‡∏£‡πá‡∏ß/‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏∏‡∏î"** ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏°‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á User Journey! üéâ
